{
  "project": "ImgPrompter Accordion UI",
  "branchName": "ralph/accordion-ui",
  "description": "Add progressive accordion UI and GPT Image 1.5 support. Rename ChatGPT to GPT Image and enable image generation via Replicate.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Create reusable Accordion component",
      "description": "As a developer, I need a reusable Accordion component that supports open/close toggle, completed state styling, and summary content when collapsed.",
      "acceptanceCriteria": [
        "Create components/ui/Accordion.tsx with AccordionItem subcomponent",
        "Props: isOpen, onToggle, title, summary, isCompleted, children",
        "Show checkmark icon when isCompleted=true",
        "Show chevron toggle (> when collapsed, v when open)",
        "Smooth height animation on open/close",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Created components/ui/Accordion.tsx"
    },
    {
      "id": "US-002",
      "title": "Wrap API Key section in accordion",
      "description": "As a user, I want the API key section to collapse after I save my key so I can focus on the next step.",
      "acceptanceCriteria": [
        "Wrap ApiKeyInput in Accordion component",
        "Auto-collapse when valid API key is entered (starts with 'r8_')",
        "Show masked key in summary when collapsed (e.g., 'r8_xxx...xxx')",
        "User can manually expand/collapse at any time",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Implemented in StyleExtractorWizard.tsx"
    },
    {
      "id": "US-003",
      "title": "Wrap Upload section in accordion",
      "description": "As a user, I want the upload section to collapse after style extraction so I can focus on the prompts.",
      "acceptanceCriteria": [
        "Wrap UploadStep content in Accordion component",
        "Auto-collapse when prompts are successfully extracted",
        "Show summary when collapsed: thumbnail, filename, subject if set",
        "User can manually expand/collapse at any time",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Implemented in StyleExtractorWizard.tsx"
    },
    {
      "id": "US-004",
      "title": "Wrap Style Prompt section in accordion",
      "description": "As a user, I want the style prompt section to collapse after generating an image so I can focus on the result.",
      "acceptanceCriteria": [
        "Wrap ResultStep prompt area in Accordion component",
        "Auto-collapse when image is successfully generated",
        "Show summary when collapsed: platform name + truncated prompt",
        "Generated image section remains visible below",
        "User can manually expand/collapse at any time",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Implemented with onImageGenerated callback"
    },
    {
      "id": "US-005",
      "title": "Add Generated Image accordion section",
      "description": "As a user, I want the generated image to be in its own section that expands when an image is ready.",
      "acceptanceCriteria": [
        "Create separate accordion section for generated image",
        "Auto-expand when image generation completes",
        "Show loading state during generation",
        "Show thumbnail in summary when collapsed",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Created GeneratedImageSection.tsx component"
    },
    {
      "id": "US-006",
      "title": "Fix duplicate headings in accordions",
      "description": "As a user, I don't want to see duplicate labels/headings when sections are expanded.",
      "acceptanceCriteria": [
        "Remove duplicate 'REPLICATE API KEY' label from ApiKeyInput",
        "Remove Accordion wrapper from Style Prompts (keep it always visible)",
        "No duplicate headers shown in any section",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Removed label from ApiKeyInput, removed Accordion from ResultStep"
    },
    {
      "id": "US-007",
      "title": "Unified image grid below tabs",
      "description": "As a user, I want generated images to appear in a grid below the prompt tabs, not inside tabs, so images persist when switching tabs.",
      "acceptanceCriteria": [
        "Move generated image display from inside tabs to below tabs",
        "Images stored as array with {url, platform, timestamp}",
        "Images persist across tab switches",
        "Display in 2x2 grid layout",
        "Each image shows platform label",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Refactored image storage to array, moved grid below tabs"
    },
    {
      "id": "US-008",
      "title": "Clear images on re-extract",
      "description": "As a user, I want generated images cleared when I re-extract style, so old images don't confuse me.",
      "acceptanceCriteria": [
        "Clear all generated images when Extract Style clicked",
        "Clear images from localStorage too",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Clear localStorage in handleExtract"
    },
    {
      "id": "US-009",
      "title": "Wrap Style Prompts in accordion (user-initiated only)",
      "description": "As a user, I want the Style Prompts section in an accordion so I can collapse it when not needed, but it should NOT auto-collapse.",
      "acceptanceCriteria": [
        "Wrap entire Style Prompts section in Accordion component",
        "Starts open by default",
        "NO auto-collapse on any event",
        "User can manually toggle open/close",
        "Summary shows 'From X image(s)' when collapsed",
        "Same styling as API Key and Upload accordions",
        "Typecheck passes",
        "Verify in browser using browser skill"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Wrapped ResultStep in Accordion, removed duplicate header from ResultStep"
    },
    {
      "id": "US-010",
      "title": "Separate Generated Images accordion with 3-column grid",
      "description": "As a user, I want Generated Images in its own accordion section (separate from Style Prompts) with a 3-column grid layout.",
      "acceptanceCriteria": [
        "Generated Images is a separate accordion below Style Prompts",
        "Accordion shows image count in summary when collapsed",
        "Grid uses 3 columns instead of 2",
        "Lightbox still works when clicking images",
        "Clear All button still works",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Lifted generated images state to StyleExtractorWizard, created separate accordion, changed grid to 3 columns"
    },
    {
      "id": "US-011",
      "title": "Install ZIP and PDF dependencies",
      "description": "As a developer, I need libraries to create ZIP files and PDFs client-side.",
      "acceptanceCriteria": [
        "Install jszip package",
        "Install file-saver package",
        "Install jspdf package",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Installed jszip@3.10.1, file-saver@2.0.5, jspdf@4.0.0, @types/file-saver"
    },
    {
      "id": "US-012",
      "title": "Create Download All button in Generated Images accordion",
      "description": "As a user, I want a Download All button next to Clear All when images are generated.",
      "acceptanceCriteria": [
        "Add 'Download All' button next to 'Clear All'",
        "Button disabled when no images",
        "Button shows 'Preparing...' with spinner when downloading",
        "Same styling as Clear All button",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Added isDownloading state, handleDownloadAll placeholder, and Download All button with spinner"
    },
    {
      "id": "US-013",
      "title": "Create ZIP with images and prompt text files",
      "description": "As a user, I want the ZIP to contain images in an images/ folder and prompts as .txt files.",
      "acceptanceCriteria": [
        "Create utils/downloadExport.ts",
        "ZIP contains images/{platform}-{timestamp}.png for each image",
        "ZIP contains prompts/{platform}.txt for each prompt (all 4 platforms)",
        "Each .txt file has platform name, full model name, and prompt text",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Created utils/downloadExport.ts with createExportZip function using JSZip"
    },
    {
      "id": "US-014",
      "title": "Add README.md to ZIP export",
      "description": "As a user, I want a README.md in the ZIP with all prompts and image references.",
      "acceptanceCriteria": [
        "Generate README.md with title and generation date",
        "Each platform section has prompt text",
        "Sections with generated images include markdown image reference",
        "ChatGPT section included (text-only, no image)",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Added generateReadme function with image references and platform sections"
    },
    {
      "id": "US-015",
      "title": "Add PDF summary to ZIP export",
      "description": "As a user, I want a summary.pdf in the ZIP with images and prompts.",
      "acceptanceCriteria": [
        "Generate PDF using jsPDF",
        "PDF has title and generation date",
        "Each platform section shows image thumbnail (if exists) and prompt text",
        "PDF is A4 format, readable layout",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Added generatePDF function using jsPDF with images embedded and text layout"
    },
    {
      "id": "US-016",
      "title": "Rename chatgpt to gpt_image in type definitions",
      "description": "As a developer, I need to rename the chatgpt platform key to gpt_image throughout the type system.",
      "acceptanceCriteria": [
        "Update PlatformKey type in services/styleExtraction.ts: chatgpt → gpt_image",
        "Update PlatformPrompts interface: chatgpt → gpt_image",
        "Update utils/styleExtractionClient.ts: chatgpt → gpt_image",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Updated types in styleExtraction.ts, styleExtractionClient.ts"
    },
    {
      "id": "US-017",
      "title": "Update style extraction prompts for GPT Image",
      "description": "As a developer, I need to update the prompt labels from CHATGPT to GPT_IMAGE in style extraction.",
      "acceptanceCriteria": [
        "Change 'CHATGPT:' to 'GPT_IMAGE:' in all 6 specialized prompts",
        "Update parsePlatformPrompts() label matching",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Changed all 6 CHATGPT labels to GPT_IMAGE in styleExtraction.ts"
    },
    {
      "id": "US-018",
      "title": "Add GPT Image 1.5 to generate-image API",
      "description": "As a developer, I need to add GPT Image 1.5 model support to the image generation API.",
      "acceptanceCriteria": [
        "Add gpt_image to GeneratePlatform type in generateImageClient.ts",
        "Add gpt_image: 'openai/gpt-image-1.5' to MODEL_MAP in route.ts",
        "Add gpt_image to SUPPORTED_PLATFORMS array",
        "Add getModelInput case with quality: 'high', aspect_ratio: '1:1', output_format: 'webp'",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Added model to route.ts with proper config"
    },
    {
      "id": "US-019",
      "title": "Update ResultStep UI for GPT Image",
      "description": "As a user, I want to see GPT Image as a platform option that can generate images.",
      "acceptanceCriteria": [
        "Rename chatgpt → gpt_image in PLATFORM_CONFIG",
        "Update label: 'ChatGPT' → 'GPT Image'",
        "Add fullModelName: 'OpenAI GPT Image 1.5'",
        "Add gpt_image to REPLICATE_SUPPORTED_PLATFORMS (now all 4 generate)",
        "Update cost estimate: '4 images (~$0.08-0.16 total)'",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Updated ResultStep.tsx with all 4 platforms generating images"
    },
    {
      "id": "US-020",
      "title": "Update downloadExport for GPT Image",
      "description": "As a developer, I need to update the download export utilities for the renamed platform.",
      "acceptanceCriteria": [
        "Rename chatgpt → gpt_image in PLATFORM_CONFIG",
        "Update label to 'GPT Image'",
        "Update fullModelName to 'OpenAI GPT Image 1.5'",
        "Update PLATFORM_ORDER array",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Updated downloadExport.ts, removed text-only handling"
    }
  ]
}
